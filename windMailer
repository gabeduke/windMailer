#!/usr/bin/env python
import forecastio
import slackweb
import ConfigParser

Config = ConfigParser.ConfigParser()
Config.read("properties")

if not Config.get("API_KEYS", "web_hook"):
    i = raw_input("Please enter Slack Web Hook: ")
    Config.set("API_KEYS", "web_hook", i)\

if not Config.get("API_KEYS", "forecast_key"):
    i = raw_input("Please enter ForecastIO (Darksky) Api Key: ")
    Config.set("API_KEYS", "forecast_key", i)

with open('properties', 'w') as configfile:
    Config.write(configfile)

web_hook = Config.get("API_KEYS", "web_hook")
forecast_key = Config.get("API_KEYS", "forecast_key")

lat = "37.5000327"
lng = "-77.5628374"


forecast = forecastio.load_forecast(forecast_key, lat, lng)
byDay = forecast.daily()
w = ""

print "-------------------------- DAILY --------------------------"
for dailyData in byDay.data:
    wind = dailyData.windSpeed
    time = dailyData.time
    wind_message = "Wind is expected to be " + str(wind) + "mph on " + str(time.strftime("%A\n"))

    if wind > 8:
        w += wind_message

slack = slackweb.Slack(url=web_hook)
slack.notify(text=w)
